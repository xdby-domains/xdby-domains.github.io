<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" href="/xdby.png">
    <link rel="favicon" href="/xdby.png">
    <title>XD.BY - Free Domains For All</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geologica:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS to make the <pre> tag content invisible */
        pre {
            visibility: hidden;
        }
    </style>
</head>
<body>

    <header>
        <img src="/xdby.png" alt="xd.vg Logo" class="logo">
        <nav>
            <ul>
                <li><a href="#">Home Page</a></li>
                <li><a href="/terms-of-service">Terms of Service</a></li>
                <li><a href="/contact">Contact Information</a></li>
                <li><a href="/instructions">Instructions</a></li>
                <li><a href="/blimby.html">Mr. Blimby's Page</a></li>
            </ul>
        </nav>
    </header>

    <div class="main-content">
        <h1>XD.BY- Free Domains For All</h1>
        <p>Get your free domain and start building your online presence today.</p>
        <p>Simply enter the domain name that you want below to see if yours is available.</p>
        <div class="form-container">
            <input type="text" id="domain" placeholder="yourname.xd.by">
            <button id="whois-lookup">Check Availability</button> 
        </div>
        <p><i>Note: XD.BY Domains are only allowed if they abide by our Terms of Service.</i></p>
        <pre id="output"></pre>
    </div>

    <div class="backstory">
        <h2>Why I made XD.BY</h2>
        <p>Here, I believe that people should have completely free domains, no matter what it takes for me. So I made the XD.BY website so that people can have free domains easily.</p>
    </div>

    <footer>
        <img src="/xdby.png" alt="xd.vg Logo" class="footer-logo">
        <p>&copy; 2025 Free Domains For All - XD.BY</p>
    </footer>

    <script>
        // Get the elements from the DOM
        const button = document.getElementById("whois-lookup");
        const domainInput = document.getElementById("domain");
        const output = document.getElementById("output");

        // Add an event listener to the button
        button.addEventListener("click", async () => {
            const domain = domainInput.value.trim();

            if (!domain) {
                output.textContent = "Please enter a valid domain!";
                return;
            }

            output.textContent = "Fetching WHOIS information...";

            try {
                // Replace with your actual API key here
                const apiKey = 'zocHLY9gsueBDIIef6RycA';  // Make sure to use the valid API key from jsonwhoisapi.com or your chosen provider

                // Construct the URL for the API request (without API key as query param)
                const url = `https://jsonwhoisapi.com/api/v1/whois?identifier=${domain}`;

                // Fetch WHOIS info from the API using the API key in the headers
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`
                    }
                });
                
                // Check if the response status is OK
                if (!response.ok) {
                    throw new Error(`API Request failed with status: ${response.status}`);
                }

                // Parse the JSON response
                const data = await response.json();

                // If the API returns an error
                if (data.error) {
                    output.textContent = `Error: ${data.error.message}`;
                } else {
                    output.textContent = JSON.stringify(data, null, 2);

                    // Check if domain is registered by looking for the 'domainName' or 'status' fields
                    const domainStatus = data.domainName || data.status;  // Adjust this based on actual API response

                    if (domainStatus) {
                        // Domain is registered, redirect to bigboy.com
                        window.location.href = "https://bigboy.com";
                    } else {
                        // Domain is not registered, redirect to kfc.com
                        window.location.href = "/available";
                    }
                }
            } catch (error) {
                // Handle errors in fetching or JSON parsing
                console.error("Error:", error);
                output.textContent = "Error fetching WHOIS information: " + error.message;
            }
        });
    </script>

</body>
</html>
